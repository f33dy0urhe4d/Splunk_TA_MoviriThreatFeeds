#!/bin/bash
#Script that downloads the Malware Domains Full List
#
#==============================================================================
#Fix error when calling script from Splunk
#==============================================================================

unset LD_LIBRARY_PATH

#==============================================================================
#Malware - Malware Domain Full List
#==============================================================================

logger -t Splunk-TFPS-MalwareDomainsFull "Malware Domains Full List"

wget http://mirror1.malwaredomains.com/files/domains.txt -O /tmp/malwaredomains_full

if [ -s /tmp/malwaredomains_full ]
then
   echo "# Generated: `date`" >  /opt/splunk/etc/apps/moviri-threatfeeds/logs/malwaredomains_full.domain

   cat /tmp/malwaredomains_full | grep -v \# | cut -f 3,4 | sed 's/^/Domain=/' | sed 's/$/ Malware Domains Full List/' >> /opt/splunk/etc/apps/moviri-threatfeeds/logs/malwaredomains_full.domain
fi

rm /tmp/malwaredomains_full
